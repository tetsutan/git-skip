#!/bin/sh

if \git rev-parse --is-inside-work-tree > /dev/null 2>&1; then

  dir_or_path=$@

  if [ -d "$dir_or_path" ]; then
    pathes=$(\git status --porcelain $dir_or_path | \grep "^ M" | \sed s/^...//)
    root=$(\git rev-parse --show-toplevel)
    pushd $root > /dev/null
    echo $pathes | xargs -L 1 git skip
    popd > /dev/null
  else
    \git update-index --skip-worktree $dir_or_path
  fi

fi


